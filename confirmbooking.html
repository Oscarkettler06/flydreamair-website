<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Confirm Booking – FlyDreamAir</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="navbar">
    <div class="navbar-logo">
      <img src="images/airplane.png" alt="FlyDreamAir Logo">
      <span>FlyDreamAir</span>
    </div>
    <div class="navbar-links">
      <a href="index.html">Home</a>
      <a href="search.html">Search</a>
      <a href="upcomingbooking.html">Upcoming</a>
      <a href="confirmbooking.html" class="active">Confirm</a>
      <a href="loungecheckin.html">Check-In</a>
      <a href="membership.html">Membership</a>
      <a href="profile.html">Profile</a>
    </div>
  </nav>

  <main class="main-container" style="margin-top: 110px;">
    <!-- Header -->
    <div class="header">
      <h1>Confirm Your Booking</h1>
    </div>
    <p class="welcome-text" id="welcome-text">Hello, Guest</p>
            <p id="membership-perks"></p>

    <!-- Booking Details -->
    <div class="booking-details">
      <!-- left column: form -->
      <div class="booking-form">
        <!-- 1) Lounge dropdown -->
        <div class="form-group">
          <label for="lounge-select">Lounge</label>
          <select id="lounge-select">
            <option value="">Select a lounge...</option>
            <option value="Sydney Gold Lounge">Sydney Gold Lounge</option>
            <option value="Melbourne Executive Lounge">Melbourne Executive Lounge</option>
            <option value="Brisbane Serenity Lounge">Brisbane Serenity Lounge</option>
          </select>
        </div>

        <!-- 2) Date picker -->
        <div class="form-group">
          <label for="booking-date">Date</label>
          <input type="date" id="booking-date">
        </div>

        <!-- 3) Time picker -->
        <div class="form-group">
          <label for="booking-time">Time</label>
          <input type="time" id="booking-time">
        </div>

        <!-- 4) Guests & Price (static) -->
        <div class="form-group">
          <label for="guest-select">Guests</label>
            <select id="guest-select">
              <option value="1">1 Guest</option>
              <option value="2">2 Guests</option>
              <option value="3">3 Guests</option>
              <option value="4">4 Guests</option>
              <option value="5">5 Guests</option>
              <option value="6">6 Guests</option>
            </select>
        </div>
        <p>
          <strong>Price:</strong>
          $<span id="price">80</span>
        </p>
        
        <!-- 5) Time Until Booking (calculated) -->
        <p><strong>Time Until Booking:</strong> <span id="time-until">—</span></p>
      </div>

      <!-- right column: image preview -->
      <div class="booking-image">
        <img id="lounge-preview" src="" alt="Lounge preview" />
      </div>
    </div>

    <!-- Payment Section -->
    <div class="payment-container">
      <!-- Payment Selection -->
      <div class="payment-methods">
        <h3>Choose Payment Method</h3>
        <label class="payment-option">
          <input type="radio" name="payment" value="card" checked>
          Credit or Debit Card
        </label>
        <label class="payment-option">
          <input type="radio" name="payment" value="visa">
          <img src="./Images/visa-icon.png" alt="Visa"> Visa
        </label>
        <label class="payment-option">
          <input type="radio" name="payment" value="applepay">
          <img src="./Images/applepay-icon.png" alt="Apple Pay"> Apple Pay
        </label>
        <label class="payment-option">
          <input type="radio" name="payment" value="googlepay">
          <img src="./Images/googlepay-icon.png" alt="Google Pay"> Google Pay
        </label>
      </div>

      <!-- Payment Informations -->
      <div class="payment-details">
        <!-- Credit / Debit Card Form -->
        <div class="payment-form" id="form-card">
          <div class="form-group">
            <label for="card-name">Cardholder Name</label>
            <input type="text" id="card-name" placeholder="Full name on card">
          </div>
          <div class="form-group">
            <label for="card-number">Card Number</label>
            <input type="text" id="card-number" maxlength="19" placeholder="1234 5678 9012 3456">
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="card-expiry">Expiry Date</label>
              <input type="month" id="card-expiry">
            </div>
            <div class="form-group">
              <label for="card-cvc">CVC</label>
              <input type="text" id="card-cvc" maxlength="4" placeholder="123">
            </div>
          </div>
        </div>

        <!-- Visa-Specific Form -->
        <div class="payment-form" id="form-visa">
          <div class="form-group">
            <label for="visa-card-number">Visa Card Number</label>
            <input type="text" id="visa-card-number" maxlength="19" placeholder="1234 5678 9012 3456">
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="visa-expiry">Expiry Date</label>
              <input type="month" id="visa-expiry">
            </div>
            <div class="form-group">
              <label for="visa-cvc">CVC</label>
              <input type="text" id="visa-cvc" maxlength="4" placeholder="123">
            </div>
          </div>
        </div>

        <!-- Apple Pay Form -->
        <div class="payment-form" id="form-applepay">
          <div class="form-group">
            <label for="apple-email">Apple Pay Email</label>
            <input type="email" id="apple-email" placeholder="you@apple.com">
          </div>
        </div>

        <!-- Google Pay Form -->
        <div class="payment-form" id="form-googlepay">
          <div class="form-group">
            <label for="google-email">Google Pay Email</label>
            <input type="email" id="google-email" placeholder="you@gmail.com">
          </div>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="button-container">
      <button class="primary-button" id="confirmBooking">Confirm Booking</button>
      <a href="search.html" class="primary-button cancel-link">Cancel ✕</a>
      <a href="index.html" class="primary-button back-button">
        <span>←</span> Back to Dashboard
      </a>
    </div>
  </main>

  <script>
  function getMembershipTier() {
  const name = "membershipTier=";
  const decodedCookie = decodeURIComponent(document.cookie);
  const ca = decodedCookie.split(';');
  for (let c of ca) {
    c = c.trim();
    if (c.indexOf(name) === 0) return c.substring(name.length);
  }
  return "";
}

function shouldShowPayment() {
  const tier = getMembershipTier();
  return !(tier === "Gold" || tier === "Silver");
}

function getBookingPrice(guestCount) {
  const PRICE_PER_GUEST = 80;
  if (!shouldShowPayment()) return 0;
  return (guestCount || 1) * PRICE_PER_GUEST;
}

function updatePriceDisplay() {
  const guestSelect = document.getElementById("guest-select");
  const priceSpan = document.getElementById("price");
  const guests = parseInt(guestSelect.value, 10) || 1;
  priceSpan.textContent = getBookingPrice(guests);
}

function updatePaymentSection() {
  const paymentContainer = document.querySelector('.payment-container');
  if (!shouldShowPayment() && paymentContainer) {
    paymentContainer.style.display = 'none';
  } else if (paymentContainer) {
    paymentContainer.style.display = '';
  }
}

const first = getCookie("firstName") || "Guest";
    const last = getCookie("surname") || "";
    const tier = getCookie("membershipTier") || "";

    const welcome = document.getElementById("welcome-text");
    const perks = document.getElementById("membership-perks");

    if (welcome) welcome.textContent = "Hello, " + first + " " + last;
    if (perks) {
      if (tier === "Gold") {
        perks.textContent = "Enjoy early check-in and complimentary VIP breakfast.";
      } else if (tier === "Silver") {
        perks.textContent = "You get priority access today.";
      } else if (tier === "Bronze") {
        perks.textContent = "Earn points with every visit.";
      } else {
        perks.textContent = "Join our membership program to enjoy perks.";
      }
    }

window.addEventListener('DOMContentLoaded', () => {
  updatePriceDisplay();
  updatePaymentSection();
  const guestSelect = document.getElementById("guest-select");
  guestSelect.addEventListener("change", updatePriceDisplay);
});


  </script>

  <script>
    const loungeImages = {
      "Sydney Gold Lounge": "Images/sydneyLounge.png",
      "Melbourne Executive Lounge": "Images/melbourneLounge.png",
      "Brisbane Serenity Lounge": "Images/brisbaneLounge.png"
    };

    document.getElementById("confirmBooking").addEventListener("click", function () {
      const lounge = document.getElementById("lounge-select").value;
      const date   = document.getElementById("booking-date").value;
      const time   = document.getElementById("booking-time").value;
      const guests = parseInt(document.getElementById("guest-select").value, 10);
      const price  = parseInt(document.getElementById("price").textContent, 10);

      if (!lounge || !date || !time) {
        alert("Please complete all booking details.");
        return;
      }

      // read existing or start fresh
      const bookings = JSON.parse(localStorage.getItem("bookings") || "[]");

      // append new booking
      bookings.push({ lounge, date, time, guests, price, image: loungeImages[lounge] });

      // save back
      localStorage.setItem("bookings", JSON.stringify(bookings));

      // go show them
      window.location.href = "upcomingbooking.html";
    });
  </script>
</body>
</html>