<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lounge Check-In - FlyDreamAir</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

<h1 id="greeting">No Membership with RyanAir? You can fix that</h1>
<form id="MemberForm">
  <input type="text" id="FirstNameInput" placeholder="Your first name" required><br>
  <input type="text" id="LastNameInput" placeholder="Your last name" required><br>
  <input type="email" id="EmailInput" placeholder="Your email" required><br>
  
  <span id="tierOptions">
    <input type="radio" id="Deluxe" name="MemberTier" value="Deluxe">
    <label for="Deluxe" id="DeluxeLabel">Deluxe Tier</label>
    <input type="radio" id="Regular" name="MemberTier" value="Regular">
    <label for="Regular" id="RegularLabel">Regular Tier</label>
  </span>
  <br>
  <button type="submit">Confirm membership</button>
</form>
<p id="status"></p>
<div id="upgradeOffer" style="margin-top:10px; font-weight:bold;"></div>

<script>
function setCookie(name, value, days) {
  const date = new Date();
  date.setTime(date.getTime() + (days*24*60*60*1000));
  const expires = "expires=" + date.toUTCString();
  document.cookie = `${name}=${encodeURIComponent(value)};${expires};path=/;SameSite=Lax`;
}

function getCookie(name) {
  const cname = name + "=";
  const decodedCookie = decodeURIComponent(document.cookie);
  const ca = decodedCookie.split(';');
  for(let c of ca) {
    c = c.trim();
    if (c.indexOf(cname) === 0) return c.substring(cname.length);
  }
  return "";
}

function showGreeting() {
  const first = getCookie("firstName");
  const last = getCookie("lastName");
  if (first && last) {
    document.getElementById("greeting").innerText = `Welcome back, ${first} ${last}!`;
  }
}

function updateTierOptions() {
  const tier = getCookie("membershipTier");
  const tierOptions = document.getElementById("tierOptions");
  const regularRadio = document.getElementById("Regular");
  const regularLabel = document.getElementById("RegularLabel");
  const deluxeRadio = document.getElementById("Deluxe");
  const deluxeLabel = document.getElementById("DeluxeLabel");
  const upgradeDiv = document.getElementById("upgradeOffer");

  // Reset everything
  regularRadio.style.display = '';
  regularLabel.style.display = '';
  deluxeRadio.style.display = '';
  deluxeLabel.style.display = '';
  upgradeDiv.innerHTML = '';

  if (tier === "Regular") {
    // Hide Regular tier option
    regularRadio.style.display = 'none';
    regularLabel.style.display = 'none';

    // Show upgrade offer
    upgradeDiv.innerHTML = `You're a Regular member. <button id="upgradeBtn">Upgrade to Deluxe</button>`;
    // Show only Deluxe option
    deluxeRadio.checked = false;
    // Add upgrade logic
    document.getElementById("upgradeBtn").onclick = function() {
      setCookie("membershipTier", "Deluxe", 7);
      upgradeDiv.innerHTML = "Congratulations! You've been upgraded to Deluxe.";
      // Hide both options after upgrade
      regularRadio.style.display = 'none';
      regularLabel.style.display = 'none';
      deluxeRadio.style.display = 'none';
      deluxeLabel.style.display = 'none';
    };
  } else if (tier === "Deluxe") {
    // Hide both options and any upgrade offer
    regularRadio.style.display = 'none';
    regularLabel.style.display = 'none';
    deluxeRadio.style.display = 'none';
    deluxeLabel.style.display = 'none';
    upgradeDiv.innerHTML = '';
  }
}

document.getElementById("MemberForm").onsubmit = function(e) {
  e.preventDefault();
  const firstName = document.getElementById("FirstNameInput").value.trim();
  const lastName = document.getElementById("LastNameInput").value.trim();
  const email = document.getElementById("EmailInput").value.trim();
  const tierInput = document.querySelector('input[name="MemberTier"]:checked');
  if (!tierInput) {
    document.getElementById("status").innerText = "Please select a membership tier.";
    return;
  }
  
  const tier = tierInput.value;

  setCookie("firstName", firstName, 7);
  setCookie("lastName", lastName, 7);
  setCookie("email", email, 7);
  setCookie("membershipTier", tier, 7);

  document.getElementById("status").innerText = "Membership saved!";
  showGreeting();
  updateTierOptions();
};

window.onload = function() {
  showGreeting();
  updateTierOptions();
};
</script>
</body>
</html>